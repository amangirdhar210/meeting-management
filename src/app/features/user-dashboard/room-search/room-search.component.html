<div class="room-search" [formGroup]="searchForm">
  <div class="search-header">
    <div class="search-bar">
      <i class="fa-solid fa-search"></i>
      <input
        type="text"
        formControlName="searchText"
        placeholder="Search by room name, capacity, or amenities..."
        (input)="onSearch()"
        maxlength="200"
      />
      @if (searchForm.value.searchText) {
      <button type="button" class="clear-search-btn" (click)="clearSearch()">
        <i class="fa-solid fa-xmark"></i>
      </button>
      }
      @if (searchForm.get('searchText')?.invalid && searchForm.get('searchText')?.touched) {
      <small class="error">Search text cannot exceed 200 characters</small>
      }
    </div>
    <button
      class="filter-toggle"
      (click)="toggleFilters()"
      [class.active]="showFilters()"
    >
      <i class="fa-solid fa-sliders"></i>
      Filters
    </button>
  </div>

  @if (showFilters()) {
  <div class="filters-panel">
    <div class="filters-form">
      <div class="filter-group capacity-filter">
        <label
          >Capacity Range: {{ capacityRange()[0] }} -
          {{ capacityRange()[1] }} people</label
        >
        <p-slider
          [(ngModel)]="capacityRangeValue"
          [ngModelOptions]="{ standalone: true }"
          [range]="true"
          [min]="1"
          [max]="50"
          [step]="1"
          (onChange)="onCapacityChange($event)"
          styleClass="capacity-slider"
        />
      </div>

      <div class="filter-group">
        <label>Floor</label>
        <input
          type="number"
          formControlName="floor"
          placeholder="Any floor"
          min="1"
          max="100"
          (change)="onSearch()"
        />
        @if (searchForm.get('floor')?.invalid && searchForm.get('floor')?.touched) {
        <div class="error">
          @if (searchForm.get('floor')?.errors?.['min']) {
          <small>Floor must be at least 1</small>
          }
          @if (searchForm.get('floor')?.errors?.['max']) {
          <small>Floor cannot exceed 100</small>
          }
        </div>
        }
      </div>

      <div class="filter-group amenities-filter">
        <label>Amenities</label>
        <div class="amenities-chips">
          @for (amenity of COMMON_AMENITIES; track amenity) {
          <button
            type="button"
            class="amenity-chip"
            [class.selected]="isAmenitySelected(amenity)"
            (click)="toggleAmenity(amenity)"
          >
            @if (isAmenitySelected(amenity)) {
            <i class="fa-solid fa-check"></i>
            }
            {{ amenity }}
          </button>
          }
        </div>
      </div>

      <div class="filter-actions">
        <button type="button" class="clear-btn" (click)="clearFilters()">
          <i class="fa-solid fa-xmark"></i> Clear Filters
        </button>
      </div>
    </div>
  </div>
  }
</div>
